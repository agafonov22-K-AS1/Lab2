# Lab2
## Список уязвимостей 2022-2025 гг.

### 5 RCE (Remote Code Execution) уязвимостей:

1) CVE-2024-6387

**Источник:** https://vulners.com/cve/CVE-2024-6387

**PoC:** https://github.com/Karmakstylez/CVE-2024-6387

2) CVE-2023-38831

**Источник:** https://vulners.com/cve/CVE-2023-38831

**PoC:** https://github.com/b1tg/CVE-2023-38831-winrar-exploit

3) CVE-2022-22965

**Источник:** https://vulners.com/cve/CVE-2022-22965

**PoC:** https://github.com/reznok/Spring4Shell-POC

4) CVE-2024-3400

**Источник:** https://vulners.com/cve/CVE-2024-3400

**PoC:** https://github.com/retkoussa/CVE-2024-3400

5) CVE-2023-27350

**Источник:** https://vulners.com/cve/CVE-2023-27350

**PoC:** https://github.com/horizon3ai/CVE-2023-27350

### 5 LPE (Local Privilege Escalation) уязвимостей:

1) CVE-2024-26169

**Источник:** https://vulners.com/cve/CVE-2024-26169

**PoC:** https://github.com/advisories/GHSA-v6c8-v4w6-r8wx

2) CVE-2023-21752

**Источник:** https://vulners.com/cve/CVE-2023-21752

**PoC:** https://github.com/Wh04m1001/CVE-2023-21752

3) CVE-2024-1086

**Источник:** https://vulners.com/cve/CVE-2024-1086

**PoC:** https://github.com/Notselwyn/CVE-2024-1086

4) CVE-2023-32629

**Источник:** https://vulners.com/cve/CVE-2023-32629

**PoC:** https://github.com/g1vi/CVE-2023-2640-CVE-2023-32629

5) CVE-2024-21338

**Источник:** https://vulners.com/cve/CVE-2024-21338

**PoC:** https://github.com/hakaioffsec/CVE-2024-21338

## Анализ 4 выбранных репозиториев

### 1) CVE-2024-6387 (RCE) https://github.com/Karmakstylez/CVE-2024-6387

**Описание:** уязвимость типа гонки (race-condition) в обработчике сигнала SIGALRM сервера sshd: если клиент не аутентифицировался за время LoginGraceTime, то по сигналу вызывается обработчик, который выполняет функции, не гарантированно безопасные в контексте асинхронного сигнала (например, syslog()). 

**Работа кода:**

-В репозитории есть файл CVE-2024-6387.py и C/C-файл 7etsuo-regreSSHion.c. 

-Скрипт на Python сканирует указанные цели (IP, CIDR) на порт 22, определяет уязвимую версию OpenSSH и проверяет/эксплуатирует уязвимость с многопоточностью (ара -s аргумент) для усиления шансов условий гонки. 

-C-файл реализует фрагмент, который триггерит состояние, при котором сигнал SIGALRM вызывается в процессе sshd, пока поток уже в операции, вызывающей не-async-signal-safe функцию; тем самым происходит повреждение памяти или выполнение произвольного кода.
Последствия: удалённое выполнение кода с правами root без аутентификации.
Меры: обновление OpenSSH до версии, где исправлена обработка сигнала; ограничение доступа к SSH (например, через firewall), снижение времени LoginGraceTime, мониторинг необычной активности на SSH.

### 2) CVE‑2023‑38831 (RCE) https://github.com/b1tg/CVE-2023-38831-winrar-exploit

**Описание:** уязвимость заключается в том, что WinRAR до версии 6.23 при открытии ZIP-архива, содержащего одновременно файл и папку с одинаковым именем, неправильно обрабатывает расширения и временную директорию. В итоге при попытке открыть «безобидный» файл извлекается также и вредоносный файл внутри папки-«клона». 

**Работа кода:**

-Скрипт cve-2023-38831-exp-gen.py создает файл-ловушку: пользователь-файл (например, bait.png) и папка с тем же именем + файл внутри (bait.png.cmd). 

-Архив упакован так, что при двойном щелчке по bait.png в интерфейсе WinRAR запускается файл bait.png.cmd внутри папки. Это достигается за счёт:

--имени папки/файла с пробелом в конце или с дополнительным расширением, которое Windows игнорирует при построении ассоциаций.

--WinRAR вызывает ShellExecuteExW() с путём, в котором нормализованный файл (с удалённым пробелом) не найден, и происходит поиск файлов в той папке — выполняется *.cmd/.bat файл. 

### 3) CVE‑2023‑21752 (LPE) https://github.com/Wh04m1001/CVE-2023-21752

**Описание:** уязвимость в службе резервного копирования Windows / модуле Exchange: позволяет удалённой локальной пользователю (или сетевому ограниченному) вызвать удалённую или локальную операцию удаления произвольного файла, а затем использовать её для эскалации до SYSTEM-привилегий. 

**Работа кода:**

-В репозитории две версии эксплойта: версия v1 — удаляет произвольный файл; версия v2 — пытается на основе удаления файла запустить оболочку с повышенными привилегиями. 

-Код на C++ вызывает внутреннюю службу (Backup, SDRsvcEop) через компонент, который не проверяет правильно права пользователя и допускает выполнение операции под SYSTEM. В версии v2, после удаления файла, эксплойт пытает вызвать cmd.exe с SYSTEM-токеном.

### 4) CVE-2024-1086 (LPE) https://github.com/Notselwyn/CVE-2024-1086

**Описание:** уязвимость в подсистеме nftables ядра Linux. Ошибка возникает в механизме обработки nftables-объектов, где определённые последовательности создания, изменения или удаления таблиц и правил вызывают некорректное освобождение памяти. Итог: состояние use-after-free или double-free в коде ядра. Локальный пользователь может спровоцировать повреждение структур ядра и выполнить свой код с правами root.

**Работа кода:**

-В репозитории содержится полноценный эксплойт, построенный на взаимодействии с nftables через netlink. Программа вызывает серию системных операций, создавая и уничтожая nft-структуры до тех пор, пока ядро не попадает в состояние повреждённой памяти.

-Код эксплойта использует пользовательские пространства имён (user namespaces) и функции ядра, доступные обычному пользователю: это позволяет выполнять опасные операции без привилегий. Далее PoC форсирует use-after-free, после чего вставляет контролируемые данные в освобождённую область и получает исполнение произвольного кода в режиме ring-0. После успешной эксплуатации запускается root-оболочка.
